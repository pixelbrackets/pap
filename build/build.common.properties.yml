settings:
  web-directory: web/
  #prepare-sync-paths:
  #  - source: src/html/build/assets/
  #    target: www/web/assets/
  #  - source: src/php/packages/*
  #    target: www/local-packages/
  #    exclude:
  #      - .gitignore
  sync-paths:
    - source: content/
      target: web/content/
      #target: ${settings.web-directory}content/
      #exclude: ['content-subfolder-1/', 'content-subfolder-2/']
    - source: themes/theclassy/
      target: web/themes/theclassy/
    #- source: www/composer.json
    #  target: composer.json
    #- source: www/composer.lock
    #  target: composer.lock
    #- source: www/local-packages/
    #  target: local-packages/
    #- source: www/vendor/
    #  target: vendor/
  #watch:
  #  working-directory: src/
  view:
    open-browser-after-deployment: true
  assets:
    mirror:
      source: src/html/assets/
      target: src/html/build/assets/
    minify-css:
      - source: src/html/build/assets/css/stylesheet.css
        target: src/html/build/assets/css/stylesheet.css
    minify-js:
      - source: src/html/build/assets/js/bootstrap.js
        target: src/html/build/assets/js/bootstrap.js
    concat:
      - sources:
          - src/html/build/assets/css/features.css
          - src/html/build/assets/css/fonts.css
        target: src/html/build/assets/css/zen.css
    minify-img:
      - source: src/html/build/assets/img/*
        target: src/html/build/assets/img/
    #grunt:
    #  working-directory: src/html/
    #  task: live
    #scripts:
    #  - (cd src/html/ && ./build.sh)
  #composer:
  #  working-directory: www/
  #  #phar: /usr/local/bin/composer
  #lint:
  #  php-cs-rules: '@PSR2'
  #  lint-paths:
  #    - src/typo3/
  #test:
  #  codeception:
  #    working-directory: test/
  #    #suite: acceptance

stages:
  test:
    user: johndoe
    host: example.com
    origin: https://test.example.com
    working-directory: /var/dev/
    rsync:
      options: -razce 'ssh -p 22'
  live:
    user: johndoe
    host: example.com
    origin: https://www.example.com
    working-directory: /var/www/
    rsync:
      options: -razce 'ssh -p 22'
    composer:
      phar: ${stages.live.working-directory}composer.phar
    lock-branches:
      - master
    #test:
    #  deny-groups:
    #    - dataflow
